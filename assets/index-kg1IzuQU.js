import{_ as $,u as F,p as R,m as j,q as z,c as _,b as t,d as l,j as C,i as v,F as T,l as U,e as h,t as c,f as d,w as u,g as D,n as M,r as P,o as a,k as q,E as O}from"./index-Bfuw7jOH.js";import{v as A}from"./loading--dFI0u8z.js";import{E as G}from"./empty-DOR2n3QR.js";import{E as H}from"./button-Csaq6irE.js";import{E as J}from"./popover-CofmkAMI.js";import"./popper-B_1onC4U.js";import"./input-CuhcEd3j.js";import{E as K}from"./input-number-CqUmNvS-.js";import{E as Q}from"./checkbox-bDsxlDxp.js";import{u as W}from"./cartStore-Bk7iplHK.js";import"./focus-trap-wkvATaSW.js";import"./event-BB_Ol6Sd.js";import"./error-Cq9Fpw4b.js";import"./isEqual-Ba_vAUvB.js";import"./overlay-BXDXPMzz.js";import"./vnode-D0c45a3L.js";import"./scroll-BQwzGG1v.js";const X={class:"xtx-cart-page"},Y={class:"container m-top-20"},Z={key:0,class:"cart"},tt={width:"120"},et={class:"goods"},ot=["src"],st={class:"name ellipsis"},nt={class:"tc"},lt={class:"tc"},at={class:"tc"},rt={class:"f16 red"},it={class:"tc"},ct={class:"action"},dt={class:"batch"},ut={class:"red"},pt={class:"total"},mt={key:1,class:"empty"},_t={colspan:"6"},ht={class:"cart-none"},ft=Object.assign({name:"CartList"},{__name:"index",setup(kt){const g=F(),s=W(),w=(n,e,i,p)=>{s.updateCart(n,e,i,p)},x=n=>{s.delCart([n.skuId])},b=(n,e,i,p)=>{s.singleCheck(n),s.updateCart(e,i,p,n)},E=n=>{console.log(n),s.allCheck()},f=D(),L=()=>{s.cartList.find(n=>n.selected===!0)?f.push("/checkout"):O({message:"您还未选择选择商品",type:"warning"})},V=M(),r=R(!1);return j(async()=>{r.value=!1,await s.getCartList(),await s.clearCheck(),setTimeout(()=>{r.value=!0},1e3)}),z(()=>V.path,async()=>{r.value=!1,await s.getCartList(),await s.clearCheck(),setTimeout(()=>{r.value=!0},1e3)}),(n,e)=>{const i=Q,p=P("RouterLink"),I=K,S=J,k=H,B=G,N=A;return a(),_("div",X,[t("div",Y,[l(s).cartList.length&&l(g).userInfo.token?(a(),_("div",Z,[t("table",null,[t("thead",null,[t("tr",null,[t("th",tt,[r.value?(a(),C(i,{key:0,"model-value":l(s).allCheckSelected,onChange:E},null,8,["model-value"])):v("",!0)]),e[2]||(e[2]=t("th",{width:"400"},"商品信息",-1)),e[3]||(e[3]=t("th",{width:"220"},"单价",-1)),e[4]||(e[4]=t("th",{width:"180"},"数量",-1)),e[5]||(e[5]=t("th",{width:"180"},"小计",-1)),e[6]||(e[6]=t("th",{width:"140"},"操作",-1))])]),t("tbody",null,[(a(!0),_(T,null,U(l(s).cartList,(o,y)=>(a(),_("tr",{key:o.id},[t("td",null,[r.value?(a(),C(i,{key:0,"model-value":o.selected,onChange:m=>b(y,o.skuId,m,o.count)},null,8,["model-value","onChange"])):v("",!0)]),t("td",null,[t("div",et,[d(p,{to:"/"},{default:u(()=>[t("img",{src:o.picture,alt:""},null,8,ot)]),_:2},1024),t("div",null,[t("p",st,c(o.name),1)])])]),t("td",nt,[t("p",null,"¥"+c(o.price),1)]),t("td",lt,[q(d(I,{min:0,max:o.stock,modelValue:o.count,"onUpdate:modelValue":m=>o.count=m,onChange:m=>w(o.skuId,o.selected,o.count,y)},null,8,["max","modelValue","onUpdate:modelValue","onChange"]),[[N,o.loading]])]),t("td",at,[t("p",rt,"¥"+c((o.price*o.count).toFixed(2)),1)]),t("td",it,[t("p",null,[d(S,{title:"确认删除吗?","confirm-button-text":"确认","cancel-button-text":"取消",onConfirm:m=>x(o)},{reference:u(()=>e[7]||(e[7]=[t("a",{href:"javascript:;"},"删除",-1)])),_:2},1032,["onConfirm"])])])]))),128))])]),t("div",ct,[t("div",dt,[h(" 共 "+c(l(s).allCount)+" 件商品，已选择 "+c(l(s).selectedCount)+" 件，商品合计： ",1),t("span",ut,"¥ "+c(l(s).selectedPrice.toFixed()),1)]),t("div",pt,[d(k,{size:"large",type:"primary",onClick:L},{default:u(()=>e[8]||(e[8]=[h("下单结算")])),_:1})])])])):(a(),_("div",mt,[t("table",null,[t("tbody",null,[t("tr",null,[t("td",_t,[t("div",ht,[d(B,{description:"购物车列表为空",style:{height:"500px"}},{default:u(()=>[d(k,{size:"large",type:"primary",onClick:e[0]||(e[0]=o=>l(f).push("/"))},{default:u(()=>e[9]||(e[9]=[h("随便逛逛")])),_:1}),l(g).userInfo.token?v("",!0):(a(),C(k,{key:0,size:"large",type:"primary",onClick:e[1]||(e[1]=o=>l(f).push("/login"))},{default:u(()=>e[10]||(e[10]=[h("去登陆")])),_:1}))]),_:1})])])])])])]))])])}}}),jt=$(ft,[["__scopeId","data-v-4a803c50"]]);export{jt as default};
